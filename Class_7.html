<!DOCTYPE html>
<!--
  Google HTML5 slide template

  Authors: Luke Mah?? (code)
           Marcin Wichary (code and design)
           
           Dominic Mazzoni (browser compatibility)
           Charles Chen (ChromeVox support)

  URL: http://code.google.com/p/html5slides/
-->

<html>
  <head>
    <title>Presentation</title>
    <meta charset='utf-8'>
    
    <!-- LOAD HTML5SLIDES CSS FILES AND JS -->
    <link rel="stylesheet" href="html5slides/styles.css">
    <script src='html5slides/slides.js'></script>
    
    <!-- LOAD HIGHLIGHTER CSS FILES AND JS -->
    <link rel="stylesheet" href="highlight/acid.css">
    
    <!-- LOAD MATHJAX JS -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
      });
    </script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    
    <!-- LOAD CUSTOM CSS AND JS -->
        
  </head>
  
  <body style='display: none'>
     <section class='slides layout-regular template-default'>
       <article>
         <h1>Class 7</h1>

       </article>
       <article>
         <h3>One-Way ANOVA</h3>

<ul>
<li><p>Fixed effects ANOVA</p></li>
<li><p>Random effects ANOVA</p></li>
</ul>

       </article>
       <article>
         <h3>Data Generation</h3>

<p>Population mean: 50</p>

<p>Number of selected subpopulation: 6
S.D. of Subpopulations: 5</p>

<p>Number of samples: 20
S.D. of residuals: 3</p>

       </article>
       <article>
         <h3>Fixed effects ANOVA</h3>

<div class="chunk"><div class="rcode"><div class="source"><pre class="knitr"><span class="functioncall">boxplot</span><span class="keyword">(</span><span class="symbol">y</span><span class="keyword">~</span><span class="symbol">x</span><span class="keyword">,</span> <span class="argument">data</span><span class="argument">=</span><span class="symbol">data</span><span class="keyword">,</span> <span class="argument">col</span><span class="argument">=</span><span class="string">'red'</span><span class="keyword">)</span>
<span class="functioncall">abline</span><span class="keyword">(</span><span class="argument">h</span><span class="argument">=</span><span class="functioncall">mean</span><span class="keyword">(</span><span class="symbol">data</span><span class="keyword">$</span><span class="symbol">y</span><span class="keyword">[</span><span class="symbol">data</span><span class="keyword">$</span><span class="symbol">x</span>==<span class="functioncall">levels</span><span class="keyword">(</span><span class="symbol">data</span><span class="keyword">$</span><span class="symbol">x</span><span class="keyword">)</span><span class="keyword">[</span><span class="number">1</span><span class="keyword">]</span><span class="keyword">]</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">lwd</span><span class="argument">=</span><span class="number">5</span><span class="keyword">)</span>
</pre></div></div><div class="rimage default"><img src="figure/class701.png" class="plot" /></div></div>

       </article>
       <article>
         <div class="chunk"><div class="rcode"><div class="source"><pre class="knitr"><span class="symbol">model.fixed</span><span class="assignement">&lt;-</span><span class="functioncall">lm</span><span class="keyword">(</span><span class="symbol">y</span><span class="keyword">~</span><span class="symbol">x</span><span class="keyword">,</span> <span class="symbol">data</span><span class="keyword">)</span>
<span class="functioncall">print</span><span class="keyword">(</span><span class="functioncall">summary</span><span class="keyword">(</span><span class="symbol">model.fixed</span><span class="keyword">)</span><span class="keyword">$</span><span class="symbol">coef</span><span class="keyword">,</span> <span class="argument">dig</span><span class="argument">=</span><span class="number">3</span><span class="keyword">)</span>
</pre></div><div class="output"><pre class="knitr">##             Estimate Std. Error t value  Pr(>|t|)
## (Intercept)   49.812      0.588  84.708 8.83e-105
## x8             0.398      0.832   0.478  6.34e-01
## x9             7.952      0.832   9.562  2.91e-16
## x18           -2.733      0.832  -3.286  1.35e-03
## x19           -7.578      0.832  -9.113  3.23e-15
## x23            7.267      0.832   8.739  2.36e-14
</pre></div><div class="source"><pre class="knitr"><span class="symbol">model.fixed.mean</span><span class="assignement">&lt;-</span><span class="functioncall">lm</span><span class="keyword">(</span><span class="symbol">y</span><span class="keyword">~</span><span class="symbol">x</span><span class="keyword">-</span><span class="number">1</span><span class="keyword">,</span> <span class="symbol">data</span><span class="keyword">)</span>
<span class="functioncall">print</span><span class="keyword">(</span><span class="functioncall">summary</span><span class="keyword">(</span><span class="symbol">model.fixed.mean</span><span class="keyword">)</span><span class="keyword">$</span><span class="symbol">coef</span><span class="keyword">,</span> <span class="argument">dig</span><span class="argument">=</span><span class="number">3</span><span class="keyword">)</span>
</pre></div><div class="output"><pre class="knitr">##     Estimate Std. Error t value  Pr(>|t|)
## x3      49.8      0.588    84.7 8.83e-105
## x8      50.2      0.588    85.4 3.62e-105
## x9      57.8      0.588    98.2 5.15e-112
## x18     47.1      0.588    80.1 4.94e-102
## x19     42.2      0.588    71.8  9.28e-97
## x23     57.1      0.588    97.1 1.97e-111
</pre></div></div></div>

       </article>
       <article>
         <h3>Random effects ANOVA</h3>

<div class="chunk"><div class="rcode"><div class="source"><pre class="knitr"><span class="symbol">colors</span><span class="assignement">=</span><span class="functioncall">rep</span><span class="keyword">(</span><span class="string">'white'</span><span class="keyword">,</span> <span class="symbol">npop</span><span class="keyword">)</span>
<span class="symbol">colors</span><span class="keyword">[</span><span class="symbol">selected.index</span><span class="keyword">]</span><span class="assignement">=</span><span class="string">'red'</span>
<span class="functioncall">par</span><span class="keyword">(</span><span class="argument">mai</span><span class="argument">=</span><span class="functioncall">c</span><span class="keyword">(</span><span class="number">1</span><span class="keyword">,</span><span class="number">0</span><span class="keyword">,</span><span class="number">0</span><span class="keyword">,</span><span class="number">0</span><span class="keyword">)</span><span class="keyword">)</span>
<span class="functioncall">boxplot</span><span class="keyword">(</span><span class="symbol">y</span><span class="keyword">~</span><span class="symbol">x</span><span class="keyword">,</span> <span class="argument">col</span><span class="argument">=</span><span class="symbol">colors</span><span class="keyword">)</span>
<span class="functioncall">abline</span><span class="keyword">(</span><span class="argument">h</span><span class="argument">=</span><span class="symbol">pop.grand.mean</span><span class="keyword">,</span> <span class="argument">lwd</span><span class="argument">=</span><span class="number">5</span><span class="keyword">)</span>
</pre></div></div><div class="rimage default"><img src="figure/class702.png" class="plot" /></div></div>

       </article>
       <article>
         <div class="chunk"><div class="rcode"><div class="output"><pre class="knitr">## Linear mixed model fit by REML 
## Formula: y ~ 1 + (1 | x) 
##    Data: data 
##  AIC BIC logLik deviance REMLdev
##  602 610   -298      599     596
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  x        (Intercept) 34.94    5.91    
##  Residual              6.92    2.63    
## Number of obs: 120, groups: x, 6
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)    50.70       2.42    20.9
</pre></div><div class="output"><pre class="knitr">## Population grand mean      :  34.937
</pre></div><div class="output"><pre class="knitr">## S.D. of subpopulation means:  5.9108
</pre></div><div class="output"><pre class="knitr">## S.D. of residuals          :  2.6298
</pre></div></div></div>

       </article>
       <article>
         <div class="chunk"><div class="rimage default"><img src="figure/class703.png" class="plot" /></div><div class="rcode">
<div class="output"><pre class="knitr">## $x
##    (Intercept)
## 3     -0.87566
## 8     -0.48197
## 9      6.99858
## 18    -3.58158
## 19    -8.37970
## 23     6.32033
## 
</pre></div></div></div>

       </article>
       <article>
         <h3>Two-way ANOVA</h3>

       </article>
       <article>
         <h3>Data Generation</h3>

<p>Number of population: 5
Number of elevation: 3</p>

<p>Number of samples: 120</p>

<div class="chunk"><div class="rimage default"><img src="figure/class704.png" class="plot" /></div></div>

       </article>
       <article>
         <h3>Two-way ANOVA without interaction</h3>

<div class="chunk"><div class="rcode"><div class="output"><pre class="knitr">## 
## Call:
## lm(formula = wing ~ pop + elev)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -11.909  -2.328  -0.052   2.491  12.190 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   39.352      0.376  104.58  < 2e-16 ***
## pop2          -9.379      0.450  -20.85  < 2e-16 ***
## pop3          -3.740      0.450   -8.32  6.2e-16 ***
## pop4           5.911      0.450   13.14  < 2e-16 ***
## pop5          11.364      0.450   25.27  < 2e-16 ***
## elev2          5.658      0.348   16.24  < 2e-16 ***
## elev3         10.503      0.348   30.15  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 3.48 on 593 degrees of freedom
## Multiple R-squared: 0.855,   Adjusted R-squared: 0.854 
## F-statistic:  584 on 6 and 593 DF,  p-value: <2e-16 
## 
</pre></div></div></div>

       </article>
       <article>
         <div class="chunk"><div class="rcode"><div class="source"><pre class="knitr"><span class="functioncall">print</span><span class="keyword">(</span><span class="functioncall">anova</span><span class="keyword">(</span><span class="symbol">model.twoway</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">dig</span><span class="argument">=</span><span class="number">3</span><span class="keyword">)</span>
</pre></div><div class="output"><pre class="knitr">## Analysis of Variance Table
## 
## Response: wing
##            Df Sum Sq Mean Sq F value Pr(>F)    
## pop         4  31509    7877     649 <2e-16 ***
## elev        2  11054    5527     455 <2e-16 ***
## Residuals 593   7197      12                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
</pre></div></div></div>

       </article>
       <article>
         <div class="chunk"><div class="rcode"><div class="source"><pre class="knitr"><span class="functioncall">require</span><span class="keyword">(</span><span class="symbol">effects</span><span class="keyword">)</span>
<span class="functioncall">plot</span><span class="keyword">(</span><span class="functioncall">allEffects</span><span class="keyword">(</span><span class="symbol">model.twoway</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">ask</span><span class="argument">=</span><span class="number">FALSE</span><span class="keyword">)</span>
</pre></div><div class="error"><pre class="knitr">## Error: error in evaluating the argument 'x' in selecting a method for
## function 'plot': Error in model.frame.default(wing ~ pop + elev + (pop +
## elev), subset = NULL, : variable lengths differ (found for 'pop')
</pre></div></div></div>

       </article>
       <article>
         <h3>Two-way ANOVA with interaction</h3>

<div class="chunk"><div class="rcode"><div class="output"><pre class="knitr">## 
## Call:
## lm(formula = wing ~ pop * elev)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -9.741 -2.182  0.078  1.983  9.428 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(>|t|)    
## (Intercept)   40.861      0.488   83.70  < 2e-16 ***
## pop2         -11.082      0.690  -16.05  < 2e-16 ***
## pop3          -5.725      0.690   -8.29  7.6e-16 ***
## pop4           3.481      0.690    5.04  6.2e-07 ***
## pop5           9.939      0.690   14.40  < 2e-16 ***
## elev2          3.454      0.690    5.00  7.5e-07 ***
## elev3          8.181      0.690   11.85  < 2e-16 ***
## pop2:elev2    -0.169      0.976   -0.17    0.863    
## pop3:elev2     4.393      0.976    4.50  8.2e-06 ***
## pop4:elev2     2.178      0.976    2.23    0.026 *  
## pop5:elev2     4.618      0.976    4.73  2.8e-06 ***
## pop2:elev3     5.279      0.976    5.41  9.4e-08 ***
## pop3:elev3     1.561      0.976    1.60    0.110    
## pop4:elev3     5.114      0.976    5.24  2.3e-07 ***
## pop5:elev3    -0.344      0.976   -0.35    0.725    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 3.09 on 585 degrees of freedom
## Multiple R-squared: 0.888,   Adjusted R-squared: 0.885 
## F-statistic:  331 on 14 and 585 DF,  p-value: <2e-16 
## 
</pre></div></div></div>

       </article>
       <article>
         <div class="chunk"><div class="rcode"><div class="source"><pre class="knitr"><span class="functioncall">print</span><span class="keyword">(</span><span class="functioncall">anova</span><span class="keyword">(</span><span class="symbol">model.interaction</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">dig</span><span class="argument">=</span><span class="number">3</span><span class="keyword">)</span>
</pre></div><div class="output"><pre class="knitr">## Analysis of Variance Table
## 
## Response: wing
##            Df Sum Sq Mean Sq F value Pr(>F)    
## pop         4  31509    7877   826.4 <2e-16 ***
## elev        2  11054    5527   579.9 <2e-16 ***
## pop:elev    8   1621     203    21.3 <2e-16 ***
## Residuals 585   5576      10                   
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
</pre></div></div></div>

       </article>
       <article>
         <div class="chunk"><div class="rcode"><div class="source"><pre class="knitr"><span class="functioncall">plot</span><span class="keyword">(</span><span class="functioncall">effect</span><span class="keyword">(</span><span class="string">'pop:elev'</span><span class="keyword">,</span> <span class="symbol">model.interaction</span><span class="keyword">)</span><span class="keyword">)</span>
</pre></div><div class="error"><pre class="knitr">## Error: error in evaluating the argument 'x' in selecting a method for
## function 'plot': Error in model.frame.default(wing ~ pop * elev + (pop +
## elev), subset = NULL, : variable lengths differ (found for 'pop')
</pre></div></div></div>

       </article>
       <article>
         <h3>ANCOVA model</h3>

<ul>
<li>Linear model with factor and continuous variables intermixed</li>
</ul>

       </article>
       <article>
         <h3>Data Generation</h3>

<p>Number of population: 3</p>

<p>Number of samples: 20</p>

<div class="chunk"><div class="rimage default"><img src="figure/class708.png" class="plot" /></div></div>

       </article>
       <article>
         <div class="chunk"><div class="rcode"><div class="source"><pre class="knitr"><span class="symbol">model.ancova</span><span class="assignement">&lt;-</span><span class="functioncall">lm</span><span class="keyword">(</span><span class="symbol">mass</span><span class="keyword">~</span><span class="symbol">pop</span><span class="keyword">*</span><span class="symbol">length</span><span class="keyword">)</span>
<span class="functioncall">print</span><span class="keyword">(</span><span class="functioncall">summary</span><span class="keyword">(</span><span class="symbol">model.ancova</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">dig</span><span class="argument">=</span><span class="number">3</span><span class="keyword">)</span>
</pre></div><div class="output"><pre class="knitr">## 
## Call:
## lm(formula = mass ~ pop * length)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.156  -6.293  -0.948   7.068  19.675 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(>|t|)    
## (Intercept)      -254.716     18.235  -13.97  < 2e-16 ***
## popMassif         115.924     32.296    3.59  0.00071 ***
## popJura           203.150     24.310    8.36  2.6e-11 ***
## length              6.088      0.311   19.59  < 2e-16 ***
## popMassif:length   -2.394      0.561   -4.27  7.9e-05 ***
## popJura:length     -4.043      0.418   -9.68  2.1e-13 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Residual standard error: 10.3 on 54 degrees of freedom
## Multiple R-squared: 0.921,   Adjusted R-squared: 0.913 
## F-statistic:  126 on 5 and 54 DF,  p-value: <2e-16 
## 
</pre></div></div></div>

       </article>
       <article>
         <div class="chunk"><div class="rcode"><div class="source"><pre class="knitr"><span class="functioncall">print</span><span class="keyword">(</span><span class="functioncall">anova</span><span class="keyword">(</span><span class="symbol">model.ancova</span><span class="keyword">)</span><span class="keyword">,</span> <span class="argument">dig</span><span class="argument">=</span><span class="number">3</span><span class="keyword">)</span>
</pre></div><div class="output"><pre class="knitr">## Analysis of Variance Table
## 
## Response: mass
##            Df Sum Sq Mean Sq F value  Pr(>F)    
## pop         2  13560    6780    63.8 6.0e-15 ***
## length      1  43178   43178   406.3 < 2e-16 ***
## pop:length  2   9971    4986    46.9 1.6e-12 ***
## Residuals  54   5739     106                    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
</pre></div></div></div>

       </article>
     </section>
  </body>

</html>
